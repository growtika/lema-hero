<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lema – The Risk Engineering Platform</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #EDEAE5;
            color: #1A1A1A;
            overflow-x: hidden;
        }

        .hero {
            position: relative;
            width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 60px 40px 120px;
        }

        /* ── Header ── */
        .hero-label {
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 0.22em;
            text-transform: uppercase;
            color: #6B6560;
            margin-bottom: 16px;
        }

        .hero-headline {
            font-size: clamp(2rem, 4.5vw, 3.2rem);
            font-weight: 600;
            line-height: 1.12;
            letter-spacing: -0.025em;
            text-align: center;
            max-width: 680px;
            color: #1A1A1A;
            margin-bottom: 60px;
        }

        /* ── Feature cards row ── */
        .features-row {
            display: flex;
            justify-content: center;
            gap: 120px;
            width: 100%;
            max-width: 1100px;
            position: relative;
            z-index: 10;
        }

        .feature-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
            position: relative;
        }

        .feature-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 2px solid #1A1A1A;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 14px;
            transition: background 0.3s, transform 0.3s;
        }

        .feature-icon svg {
            width: 14px;
            height: 14px;
            transition: transform 0.3s;
        }

        .feature-card:hover .feature-icon {
            background: #1A1A1A;
            transform: scale(1.1);
        }

        .feature-card:hover .feature-icon svg line {
            stroke: #EDEAE5;
        }

        .feature-title {
            font-size: 16px;
            font-weight: 600;
            letter-spacing: -0.01em;
            margin-bottom: 6px;
            color: #1A1A1A;
        }

        .feature-subtitle {
            font-size: 13px;
            color: #8A8580;
            line-height: 1.4;
            max-width: 200px;
        }

        /* ── Connector icon (shape between card and dashed line) ── */
        .connector-icon {
            margin-top: 24px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1A1A1A;
        }

        /* ── Center visual area ── */
        .center-area {
            position: relative;
            width: 500px;
            height: 400px;
            margin-top: -10px;
        }

        /* ── SVG dashed curves ── */
        .dashed-curves {
            position: absolute;
            top: -120px;
            left: 50%;
            transform: translateX(-50%);
            width: 700px;
            height: 300px;
            pointer-events: none;
            z-index: 1;
        }

        .dashed-curves path {
            fill: none;
            stroke: #BCBAB5;
            stroke-width: 1;
            stroke-dasharray: 6 6;
            opacity: 0.7;
            transition: stroke 0.4s, opacity 0.4s, stroke-width 0.4s;
        }

        .dashed-curves path.active {
            stroke: #1A1A1A;
            opacity: 1;
            stroke-width: 1.5;
        }

        /* ── Kaleidoscope cluster ── */
        .kaleidoscope {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 300px;
        }

        .k-shape {
            position: absolute;
            color: #1A1A1A;
            transition: color 0.5s, transform 0.5s, opacity 0.5s;
            opacity: 0.85;
        }

        .k-shape.highlighted {
            color: #1A1A1A;
            opacity: 1;
            transform: scale(1.25);
        }

        .k-shape.dimmed {
            opacity: 0.15;
        }

        .k-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #1A1A1A;
            z-index: 5;
        }

        /* ── Bottom label ── */
        .bottom-label {
            text-align: center;
            margin-top: -20px;
            position: relative;
            z-index: 10;
        }

        .bottom-label .feature-title {
            font-size: 18px;
            margin-bottom: 4px;
        }

        .bottom-label .feature-subtitle {
            font-size: 13px;
            margin-bottom: 14px;
        }

        .bottom-label .feature-icon {
            margin: 0 auto;
        }

        .bottom-label:hover .feature-icon {
            background: #1A1A1A;
            transform: scale(1.1);
        }

        .bottom-label:hover .feature-icon svg line {
            stroke: #EDEAE5;
        }

        /* ── Complex bottom popup (opens upward) ── */
        .bottom-popup {
            position: absolute;
            left: 50%;
            bottom: 100%;
            transform: translateX(-50%) translateY(-8px);
            width: 680px;
            background: #FFFFFF;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 12px 60px rgba(0,0,0,0.14), 0 2px 12px rgba(0,0,0,0.06);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.35s, transform 0.35s;
            z-index: 100;
        }

        .bottom-label:hover .bottom-popup {
            opacity: 1;
            transform: translateX(-50%) translateY(-16px);
            pointer-events: auto;
        }

        .bottom-popup-header {
            font-size: 18px;
            font-weight: 700;
            color: #1A1A1A;
            margin-bottom: 20px;
        }

        .bottom-popup-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .bottom-popup-left {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .bottom-popup-right {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        /* Discovered panel */
        .discovered-panel {
            background: #FAFAF8;
            border-radius: 10px;
            padding: 18px;
            border: 1px solid #EDEAE5;
        }

        .discovered-panel-title {
            font-size: 14px;
            font-weight: 700;
            color: #1A1A1A;
            margin-bottom: 14px;
        }

        .discovered-nodes {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 8px;
            position: relative;
            height: 80px;
        }

        .node-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 10px;
            color: #6B6560;
            gap: 4px;
        }

        .node-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1.5px solid #BCBAB5;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .node-circle svg {
            width: 18px;
            height: 18px;
            color: #8A8580;
        }

        .node-center {
            border-color: #5BB89A;
            background: rgba(91,184,154,0.08);
        }

        .node-center svg {
            color: #5BB89A;
        }

        .node-label {
            font-size: 10px;
            color: #6B6560;
            text-align: center;
            max-width: 70px;
            line-height: 1.3;
        }

        .node-connector {
            width: 20px;
            height: 1px;
            background: #BCBAB5;
        }

        /* Threat scenario */
        .threat-scenario {
            border-top: 1px solid #EDEAE5;
            padding-top: 14px;
        }

        .threat-title {
            font-size: 12px;
            font-weight: 700;
            color: #1A1A1A;
            margin-bottom: 6px;
        }

        .threat-text {
            font-size: 12px;
            line-height: 1.55;
            color: #6B6560;
        }

        /* Impact panel */
        .impact-panel {
            background: #FEF2F0;
            border-radius: 10px;
            padding: 18px;
            border: 1px solid #F5D5CF;
            position: relative;
        }

        .impact-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        .impact-title {
            font-size: 14px;
            font-weight: 700;
            color: #C0392B;
        }

        .impact-badge {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .impact-text {
            font-size: 12px;
            line-height: 1.55;
            color: #6B6560;
        }

        /* Action items panel */
        .action-panel {
            background: #FAFAF8;
            border-radius: 10px;
            padding: 18px;
            border: 1px solid #EDEAE5;
        }

        .action-title {
            font-size: 14px;
            font-weight: 700;
            color: #1A1A1A;
            margin-bottom: 14px;
        }

        .action-item {
            display: flex;
            gap: 10px;
            margin-bottom: 14px;
        }

        .action-item:last-child {
            margin-bottom: 0;
        }

        .action-bullet {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 1.5px solid #BCBAB5;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .action-line {
            position: absolute;
            left: 7px;
            top: 18px;
            bottom: 0;
            width: 1.5px;
            background: #EDEAE5;
        }

        .action-content {
            flex: 1;
        }

        .action-name {
            font-size: 12px;
            font-weight: 700;
            color: #1A1A1A;
            margin-bottom: 2px;
        }

        .action-desc {
            font-size: 11px;
            line-height: 1.5;
            color: #8A8580;
        }

        /* ── Popup tooltip ── */
        .popup {
            position: absolute;
            left: 50%;
            transform: translateX(-50%) translateY(8px);
            top: 100%;
            width: 320px;
            background: #FFFFFF;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 8px 40px rgba(0,0,0,0.12), 0 2px 8px rgba(0,0,0,0.06);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s, transform 0.3s;
            z-index: 100;
        }

        .feature-card:hover .popup {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
            pointer-events: auto;
        }

        .popup-title {
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 8px;
            color: #1A1A1A;
        }

        .popup-text {
            font-size: 13px;
            line-height: 1.6;
            color: #6B6560;
        }

        .popup-tag {
            display: inline-block;
            margin-top: 12px;
            padding: 4px 10px;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 0.05em;
            border-radius: 4px;
            background: #F0EDEA;
            color: #6B6560;
        }

        /* ── Idle breathing animation ── */
        @keyframes breathe {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.03); }
        }

        .kaleidoscope.idle {
            animation: breathe 4s ease-in-out infinite;
        }

        /* ── Float animation for individual shapes ── */
        @keyframes float1 { 0%, 100% { transform: translate(0, 0) rotate(0deg); } 50% { transform: translate(3px, -4px) rotate(5deg); } }
        @keyframes float2 { 0%, 100% { transform: translate(0, 0) rotate(0deg); } 50% { transform: translate(-4px, 3px) rotate(-5deg); } }
        @keyframes float3 { 0%, 100% { transform: translate(0, 0) rotate(0deg); } 50% { transform: translate(2px, 5px) rotate(3deg); } }

        .k-shape.float-1 { animation: float1 5s ease-in-out infinite; }
        .k-shape.float-2 { animation: float2 6s ease-in-out infinite; }
        .k-shape.float-3 { animation: float3 7s ease-in-out infinite; }
    </style>
</head>
<body>

<section class="hero">
    <!-- Header -->
    <div class="hero-label">THE RISK ENGINEERING PLATFORM</div>
    <h1 class="hero-headline">The tech that turns TPRM teams<br>into Risk Engineers</h1>

    <!-- Feature Cards -->
    <div class="features-row">
        <!-- Card 1: Forensic Artifact Analysis -->
        <div class="feature-card" data-stage="forensic">
            <div class="feature-icon">
                <svg viewBox="0 0 14 14" fill="none" stroke="#1A1A1A" stroke-width="1.8">
                    <line x1="7" y1="2" x2="7" y2="12"/>
                    <line x1="2" y1="7" x2="12" y2="7"/>
                </svg>
            </div>
            <div class="feature-title">Forensic Artifact Analysis</div>
            <div class="feature-subtitle">Scan artifacts, uncover<br>what's hidden</div>
            <div class="connector-icon">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M4 16 L4 4 L16 4 Z"/>
                </svg>
            </div>
            <!-- Popup -->
            <div class="popup">
                <div class="popup-title">Forensic Artifact Analysis</div>
                <div class="popup-text">Deep-scan vendor artifacts — SOC2 reports, pen-test results, configuration files — to uncover risks that surface-level reviews miss.</div>
                <span class="popup-tag">ARTIFACT SCANNING</span>
            </div>
        </div>

        <!-- Card 2: Open-Source Recon -->
        <div class="feature-card" data-stage="recon">
            <div class="feature-icon">
                <svg viewBox="0 0 14 14" fill="none" stroke="#1A1A1A" stroke-width="1.8">
                    <line x1="7" y1="2" x2="7" y2="12"/>
                    <line x1="2" y1="7" x2="12" y2="7"/>
                </svg>
            </div>
            <div class="feature-title">Open-Source Recon</div>
            <div class="feature-subtitle">Monitor public data,<br>reveal secrets</div>
            <div class="connector-icon">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <rect x="3" y="3" width="14" height="14" transform="rotate(45 10 10)"/>
                </svg>
            </div>
            <!-- Popup -->
            <div class="popup">
                <div class="popup-title">Open-Source Recon</div>
                <div class="popup-text">Continuously monitor the public attack surface — exposed credentials, leaked data, dark-web mentions — so you know before attackers do.</div>
                <span class="popup-tag">OSINT ENGINE</span>
            </div>
        </div>

        <!-- Card 3: Blast Radius Monitor -->
        <div class="feature-card" data-stage="blast">
            <div class="feature-icon">
                <svg viewBox="0 0 14 14" fill="none" stroke="#1A1A1A" stroke-width="1.8">
                    <line x1="7" y1="2" x2="7" y2="12"/>
                    <line x1="2" y1="7" x2="12" y2="7"/>
                </svg>
            </div>
            <div class="feature-title">Blast Radius Monitor</div>
            <div class="feature-subtitle">Analyze your vendor relationship,<br>see what's off</div>
            <div class="connector-icon">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <polygon points="10,2 18,10 10,10"/>
                </svg>
            </div>
            <!-- Popup -->
            <div class="popup">
                <div class="popup-title">Blast Radius Monitor</div>
                <div class="popup-text">Map how deeply each vendor is embedded in your stack, model breach impact, and prioritise by actual blast radius — not just risk score.</div>
                <span class="popup-tag">IMPACT MODELING</span>
            </div>
        </div>
    </div>

    <!-- Dashed curves connecting cards to center -->
    <svg class="dashed-curves" viewBox="0 0 700 300">
        <path id="curve-left" d="M 130 0 C 130 100, 250 220, 350 260"/>
        <path id="curve-center" d="M 350 0 C 350 80, 350 180, 350 260"/>
        <path id="curve-right" d="M 570 0 C 570 100, 450 220, 350 260"/>
    </svg>

    <!-- Center cluster -->
    <div class="center-area">
        <div class="kaleidoscope idle" id="kaleidoscope">
            <div class="k-center"></div>
            <!-- The shapes are generated by JS below -->
        </div>
    </div>

    <!-- Bottom label (4th interactive stage) -->
    <div class="bottom-label" data-stage="agentic" style="cursor: pointer; position: relative;">
        <div class="feature-title">Agentic Risk Engineering</div>
        <div class="feature-subtitle">Uncover verified, hidden risks</div>
        <div class="feature-icon" style="margin-top: 14px;">
            <svg viewBox="0 0 14 14" fill="none" stroke="#1A1A1A" stroke-width="1.8">
                <line x1="7" y1="2" x2="7" y2="12"/>
                <line x1="2" y1="7" x2="12" y2="7"/>
            </svg>
        </div>

        <!-- Complex popup (opens upward) -->
        <div class="bottom-popup">
            <div class="bottom-popup-header">Agentic Risk Engineering</div>
            <div class="bottom-popup-grid">
                <!-- Left column -->
                <div class="bottom-popup-left">
                    <div class="discovered-panel">
                        <div class="discovered-panel-title">Discovered</div>
                        <div class="discovered-nodes">
                            <div class="node-item">
                                <div class="node-label">Layoffs</div>
                                <div class="node-circle">
                                    <svg viewBox="0 0 20 20" fill="currentColor"><circle cx="10" cy="10" r="4"/></svg>
                                </div>
                            </div>
                            <div class="node-connector"></div>
                            <div class="node-item">
                                <div class="node-label">Encryption<br>Gap</div>
                                <div class="node-circle">
                                    <svg viewBox="0 0 20 20" fill="currentColor"><circle cx="10" cy="10" r="4"/></svg>
                                </div>
                            </div>
                            <div class="node-item" style="margin: 0 -4px;">
                                <div class="node-circle node-center" style="width: 50px; height: 50px;">
                                    <svg viewBox="0 0 20 20" fill="currentColor" style="width:22px;height:22px;">
                                        <circle cx="6" cy="8" r="2.5"/>
                                        <circle cx="14" cy="8" r="2.5"/>
                                        <circle cx="10" cy="14" r="2.5"/>
                                        <line x1="6" y1="8" x2="14" y2="8" stroke="currentColor" stroke-width="0.8"/>
                                        <line x1="6" y1="8" x2="10" y2="14" stroke="currentColor" stroke-width="0.8"/>
                                        <line x1="14" y1="8" x2="10" y2="14" stroke="currentColor" stroke-width="0.8"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="node-connector"></div>
                            <div class="node-item">
                                <div class="node-label">High-Level<br>Permissions</div>
                                <div class="node-circle">
                                    <svg viewBox="0 0 20 20" fill="currentColor"><circle cx="10" cy="10" r="4"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="threat-scenario">
                        <div class="threat-title">Threat Scenario Validated</div>
                        <div class="threat-text">New privileges expose production data to an unstable vendor with open vulnerabilities.</div>
                    </div>
                </div>

                <!-- Right column -->
                <div class="bottom-popup-right">
                    <div class="impact-panel">
                        <div class="impact-header">
                            <div class="impact-title">Impact</div>
                            <div class="impact-badge">
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                    <path d="M9 1.5 L16.5 15 L1.5 15 Z" fill="#F5D5CF" stroke="#C0392B" stroke-width="1"/>
                                    <text x="9" y="13" text-anchor="middle" fill="#C0392B" font-size="10" font-weight="700">!</text>
                                </svg>
                            </div>
                        </div>
                        <div class="impact-text">Vendor has escalated permissions to live cloud production. Correlated with encryp...</div>
                    </div>
                    <div class="action-panel">
                        <div class="action-title">Action items</div>
                        <div class="action-item" style="position: relative;">
                            <div style="display: flex; flex-direction: column; align-items: center; gap: 0;">
                                <div class="action-bullet"></div>
                                <div style="width: 1.5px; height: 30px; background: #EDEAE5;"></div>
                            </div>
                            <div class="action-content">
                                <div class="action-name">Revoke Access</div>
                                <div class="action-desc">Signal Cloud Security to rollback new permissions immediately.</div>
                            </div>
                        </div>
                        <div class="action-item">
                            <div class="action-bullet"></div>
                            <div class="action-content">
                                <div class="action-name">Enforce Controls</div>
                                <div class="action-desc">Mandate encryption upgrades and require proof of staffing capacity.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
// ── Shape definitions ──
const SHAPES = {
    diamond: (s) => `<svg width="${s}" height="${s}" viewBox="0 0 20 20" fill="currentColor"><rect x="3" y="3" width="14" height="14" transform="rotate(45 10 10)"/></svg>`,
    square: (s) => `<svg width="${s}" height="${s}" viewBox="0 0 20 20" fill="currentColor"><rect x="3" y="3" width="14" height="14"/></svg>`,
    triangle: (s) => `<svg width="${s}" height="${s}" viewBox="0 0 20 20" fill="currentColor"><polygon points="10,2 18,18 2,18"/></svg>`,
    arrowRight: (s) => `<svg width="${s}" height="${s}" viewBox="0 0 20 20" fill="currentColor"><polygon points="4,4 18,10 4,16"/></svg>`,
    arrowLeft: (s) => `<svg width="${s}" height="${s}" viewBox="0 0 20 20" fill="currentColor"><polygon points="16,4 2,10 16,16"/></svg>`,
    chevron: (s) => `<svg width="${s}" height="${s}" viewBox="0 0 20 20" fill="currentColor"><polygon points="6,2 14,10 6,18"/></svg>`,
    invertedTriangle: (s) => `<svg width="${s}" height="${s}" viewBox="0 0 20 20" fill="currentColor"><polygon points="2,2 18,2 10,18"/></svg>`,
    smallDiamond: (s) => `<svg width="${s}" height="${s}" viewBox="0 0 20 20" fill="currentColor"><rect x="5" y="5" width="10" height="10" transform="rotate(45 10 10)"/></svg>`,
};

// Each shape: [type, x%, y%, size, stage, floatClass]
// stage: "forensic" | "recon" | "blast" | "core"
const CLUSTER = [
    // Ring 1 – inner (core shapes always visible)
    ["diamond", 46, 38, 16, "core", "float-1"],
    ["diamond", 54, 38, 14, "core", "float-2"],
    ["smallDiamond", 50, 32, 12, "core", "float-3"],

    // Ring 2 – forensic (top-left quadrant)
    ["square", 32, 36, 18, "forensic", "float-1"],
    ["arrowLeft", 28, 44, 16, "forensic", "float-2"],
    ["diamond", 36, 28, 14, "forensic", "float-3"],
    ["square", 24, 52, 14, "forensic", "float-1"],
    ["triangle", 30, 58, 12, "forensic", "float-2"],
    ["arrowLeft", 22, 38, 12, "forensic", "float-3"],
    ["smallDiamond", 34, 48, 10, "forensic", "float-1"],

    // Ring 2 – recon (top-center / above)
    ["diamond", 48, 24, 16, "recon", "float-2"],
    ["diamond", 52, 20, 14, "recon", "float-3"],
    ["chevron", 44, 18, 12, "recon", "float-1"],
    ["smallDiamond", 56, 26, 12, "recon", "float-2"],
    ["invertedTriangle", 50, 44, 14, "recon", "float-3"],
    ["diamond", 42, 42, 10, "recon", "float-1"],
    ["smallDiamond", 58, 42, 10, "recon", "float-2"],

    // Ring 2 – blast (top-right quadrant)
    ["arrowRight", 68, 36, 18, "blast", "float-3"],
    ["square", 72, 44, 16, "blast", "float-1"],
    ["diamond", 64, 28, 14, "blast", "float-2"],
    ["arrowRight", 76, 52, 14, "blast", "float-3"],
    ["triangle", 70, 58, 12, "blast", "float-1"],
    ["chevron", 78, 38, 12, "blast", "float-2"],
    ["smallDiamond", 66, 48, 10, "blast", "float-3"],

    // Ring 3 – outer scatter (mixed stages)
    ["diamond", 38, 62, 16, "forensic", "float-2"],
    ["arrowRight", 62, 62, 16, "blast", "float-1"],
    ["invertedTriangle", 50, 68, 14, "recon", "float-3"],
    ["square", 42, 70, 12, "forensic", "float-1"],
    ["diamond", 58, 70, 12, "blast", "float-2"],
    ["triangle", 50, 76, 14, "core", "float-3"],
    ["smallDiamond", 34, 68, 10, "forensic", "float-2"],
    ["chevron", 66, 68, 10, "blast", "float-1"],
    ["diamond", 46, 56, 12, "recon", "float-3"],
    ["diamond", 54, 56, 12, "recon", "float-1"],

    // Extra scatter for density
    ["arrowLeft", 26, 62, 14, "forensic", "float-3"],
    ["arrowRight", 74, 62, 14, "blast", "float-2"],
    ["smallDiamond", 40, 80, 10, "core", "float-1"],
    ["smallDiamond", 60, 80, 10, "core", "float-2"],
    ["diamond", 50, 84, 12, "core", "float-3"],
];

// ── Build cluster ──
const kalEl = document.getElementById('kaleidoscope');
const shapeEls = [];

CLUSTER.forEach(([type, x, y, size, stage, floatCls], i) => {
    const div = document.createElement('div');
    div.className = `k-shape ${floatCls}`;
    div.dataset.stage = stage;
    div.style.left = `${x}%`;
    div.style.top = `${y}%`;
    div.style.width = `${size}px`;
    div.style.height = `${size}px`;
    div.innerHTML = SHAPES[type](size);
    // stagger float animation
    div.style.animationDelay = `${(i * 0.3) % 4}s`;
    kalEl.appendChild(div);
    shapeEls.push(div);
});

// ── Hover interaction ──
const featureCards = document.querySelectorAll('.feature-card');
const curvePaths = {
    forensic: document.getElementById('curve-left'),
    recon: document.getElementById('curve-center'),
    blast: document.getElementById('curve-right'),
};

function activateStage(stage) {
    // Stop idle breathing
    kalEl.classList.remove('idle');

    // Highlight matching curve
    Object.values(curvePaths).forEach(p => p.classList.remove('active'));
    if (curvePaths[stage]) curvePaths[stage].classList.add('active');

    // Highlight matching shapes, dim others
    // "agentic" stage highlights ALL shapes (it's the combined output)
    shapeEls.forEach(el => {
        if (stage === 'agentic' || el.dataset.stage === stage || el.dataset.stage === 'core') {
            el.classList.add('highlighted');
            el.classList.remove('dimmed');
        } else {
            el.classList.remove('highlighted');
            el.classList.add('dimmed');
        }
    });
}

function deactivateStage() {
    // Restore idle
    kalEl.classList.add('idle');

    // Remove curve highlight
    Object.values(curvePaths).forEach(p => p.classList.remove('active'));

    // Reset shapes
    shapeEls.forEach(el => {
        el.classList.remove('highlighted', 'dimmed');
    });
}

// Top 3 feature cards
featureCards.forEach(card => {
    const stage = card.dataset.stage;
    card.addEventListener('mouseenter', () => activateStage(stage));
    card.addEventListener('mouseleave', deactivateStage);
});

// Bottom label (4th stage — "agentic")
const bottomLabel = document.querySelector('.bottom-label');
bottomLabel.addEventListener('mouseenter', () => {
    activateStage('agentic');
    // Highlight all curves for the combined stage
    Object.values(curvePaths).forEach(p => p.classList.add('active'));
});
bottomLabel.addEventListener('mouseleave', deactivateStage);
</script>

</body>
</html>
